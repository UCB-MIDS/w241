#+TITLE: Experiments and Causality 
#+OPTIONS: toc:nil 

This course introduces students to experimentation in data science. The course pays particular attention to forming causal questions, and to the designing experiments that can provide answers to these questions.

* Schedule

| Week | Topics                                  | Async Reading                                   | Sync Reading                                                            | Assignment Due        |
|------+-----------------------------------------+-------------------------------------------------+-------------------------------------------------------------------------+-----------------------|
|    1 | Experimentation                         | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/GerberGreen.2012_1.pdf][FE 1]], [[http://www.nytimes.com/2007/09/16/magazine/16epidemiology-t.html][NYT]]                                       | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Feynman.1974.pdf][Feynman]], [[https://www.cbsnews.com/news/do-suburbs-make-you-fat/][Suburbs, ]][[https://www.nytimes.com/interactive/2018/07/18/upshot/nike-vaporfly-shoe-strava.html][Shoes]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Athey.2017.pdf][Predict or Cause]]                               | None                  |
|    2 | Apples to Apples                        | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/FEDAI_ch2.pdf][FE 2]]; [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/LewisReiley.pdf][Lewis & Reiley]] (p. 1-2.5, §1; §2A-B)      | Poor Economics, Ch. 1, 3, 6;  [[http://www.lse.ac.uk/philosophy/science-and-pseudoscience-overview-and-transcript/][Lakatos]] (O): [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Rubin.2008.pdf ][Rubin]], sections 1 & 2        | [[./assignments/essays/essay1/README.md][Essay 1 Draft]], [[https://classroom.github.com/a/3ycl9TQg][PS 0]]   |
|    3 | Quantifying Uncertainty                 | FE 3.0, 3.1, 3.4                                | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Blackwell.2013.pdf][Blackwell]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Lewis.Rao.2015.pdf][Lewis and Rao]] 1, 3.1, 3.2                                    | [[https://classroom.github.com/a/2l3yfZRD][PS 1]], Revised Essay 1 |
|    4 | Blocking and Clustering                 | FE 3.6.1, 3.6.2, 4.4, 4.5                       | (O): [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Cameron_Miller_Cluster_Robust_October152013.pdf][Cluster Estimator]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Moore.2012.pdf][Block]][[https://cran.r-project.org/web/packages/blockTools/index.html][Tools]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/abadie_2017.pdf][When to Cluster]]                     | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/assignments/essays/essay2/README.md][Essay 2 draft]]         |
|    5 | Covariates and Regression               | MM 1, FE 4.1-3, MM 2, [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/MHE_chapter_2.pdf][MHE p. 16-24]]              | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Opower.pdf][Opower]] (O): FE Appendix B (p. 453), [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/morgan_rubin_2012.pdf][rerandomization]]                     | [[https://classroom.github.com/a/BxQ73zD0][PS 2]], Revised Essay 2 |
|    6 | Regression; Multi-factor Experiments    | MM 6.1, MM 95-97, FE 9.3.3, 9.4                 | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Montgomery.2016.pdf][Montgomery]] Sections 1, 3.0, 3.1, 3.2, 3.5, 4.2, Skim 5                  | Vote on Projects      |
|    7 | HTE                                     | FE 9, [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/clark_sells_2016.pdf][Multiple Comparisons]], and [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/week_07/clark_sells_2016.R][Demo]]            | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Goodson_Quibit.pdf][Goodson]] (O): [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/jlr-location-location-location.pdf][JLR]] 1, 2, 3.1, 4.3, [[https://codeascraft.com/2018/10/03/how-etsy-handles-peeking-in-a-b-testing/][Etsy]]                                   | --                    |
|    8 | Noncompliance                           | FE 5                                            | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/GerberGreen.2005.pdf][G&G 2005]]; [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/trochim_donnelly_ch_7.pdf][TD, Ch 7]]; [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/trochim_donnelly_ch_9.pdf][TD, Ch 9]]                                            | [[https://classroom.github.com/a/KOz9R4eg][PS 3]]                  |
|    9 | Spillover                               | FE 8 and [[https://eng.lyft.com/experimentation-in-a-ridesharing-marketplace-b39db027a66e#.dqcrp06rl][lyft]] and (O) [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Cohen.2016.pdf][uber]]                      | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Miguel.2004.pdf][Miguel and Kremer]]; [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Blake.2014.pdf][Blake and Cohey 2, 3]]                                 | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/assignments/peerEvaluation/earlyProgress.org][Progress Report]]       |
|   10 | Problems, Diagnostics and the Long View | FE 11.3                                         | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/DinardoPischke_1997.pdf][DiNardo and Pischke]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Simonsohn.2014.pdf][Simonsohn]] (O): [[http://varianceexplained.org/r/bayesian-ab-testing/][Robinson]]                            | --                    |
|   11 | Causality from Observation?             | MM 3.1, 4.1, 5.1                                | [[http://espin086.wordpress.com/2010/08/08/difference-in-difference-estimation-garbage-incinerators-and-home-prices/][Incinerators]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Glynn.2014.pdf][Glynn]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Dee.2015.pdf][Dee]] (O): [[https://medium.com/teconomics-blog/5-tricks-when-ab-testing-is-off-the-table-f2637e9f15a5][Glassberg Sands]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Lalive.2006.pdf][Lalive]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Rubin.2008.pdf][Rubin, Section 3]] | [[https://classroom.github.com/a/EmQaGWCU][PS 4]]                  |
|   12 | Attrition, Mediation, Generalizabilty   | FE 7, 10, [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/bates_2017.pdf][Bates 2017]]                            | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Allcott.2014.pdf][Alcott and Rogers]]                                                       | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/assignments/peerEvaluation/peerEvaluation1.org][Peer Eval 1]]           |
|   13 | Creative Experiments                    | FE 12, (O): [[https://www.thecut.com/2015/05/how-a-grad-student-uncovered-a-huge-fraud.html][Ny Mag]], [[http://www.sciencemag.org/news/2016/04/real-time-talking-people-about-gay-and-transgender-issues-can-change-their-prejudices][Science]], FE 13              | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/broockman_irregular.pdf][Broockman Irregularities]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Hughes.2017.pdf][Hughes et al.]] (O): [[https://eng.uber.com/xp/][Uber Platform]]              |                       |
|   14 | Final Thoughts                          |                                                 | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/Freedman_1991.pdf][Freedman]]                                                                | [[https://classroom.github.com/a/KBzJIiUD][PS 5]], [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/finalProject/presentationGuidelines.pdf][Presentation]]    |
|   15 | --                                      | [[https://github.com/UC-Berkeley-I-School/mids-w241/blob/main/readings/retracted_lacour.pdf][(O): Retracted LaCour]], ([[https://www.nytimes.com/2014/12/12/health/gay-marriage-canvassing-study-science.html][tl;dr]]), [[https://www.thisamericanlife.org/radio-archives/episode/584/for-your-reconsideration][Podcat (audio))]] |                                                                         | Final Paper           |

* Description 

This course *begins* with a discussion of the issues with causal inference based on observational data. We recognize that many of the decisions that we care about, whether they be business related or theoretically motivated, are /essentially/ causal in nature. 

The *center* of the course builds out an understanding of the mechanics of estimating a causal quantity. We present two major inferential paradigms, one new and one you are likely familiar with. We first present _randomization inference_ as a unifying, intuitive inferential paradigm. We then demonstrate how this paradigm sits in complement to the classical frequentist inferential paradigm. These concepts in hand, we turn focus to the design of experiments and place particular focus both answering the question that we set out to answer, and achieving maximally powered experiments through design. 

The *tail* of the course pursues two parallel tracks. In the first, students form a research question that requires a causal answer and design and implement the experiment that best answers this question. At the same time, new content presented in the course focuses on the practical stumbling blocks in running an experiment and the tests to detect these stumbling blocks. 

We hope that each student who completes the course will: 

- Become skeptical about claims of causality.  When faced with a piece of research on observational data, you should be able to tell stories that illustrate possible flaws in the conclusions.
- Understand why experimentation (generating one’s own data by doing deliberate interventions) solves the basic causal-inference problem.  You should be able to describe several examples of successful experiments and what makes you feel confident about their results.
- Appreciate the difference between laboratory experiments and field experiments.
- Appreciate how information systems and websites can be designed to make experimentation easy in the modern online
- Understand how to quantify uncertainty, using confidence intervals and statistical power calculations.
- Understand why control groups and placebos are both important.
- Design, implement, and analyze your own field experiment.
- Appreciate a few examples of what can go wrong in experiments.  Examples include administrative glitches that undo random assignment, inability to fully control the treatment (and failure to take this inability into account), and spillovers between subjects.

Computing is conducted primarily in R.

If you are looking to work on something over the break between semesters, we recommend that students spend a little time familiarizing themselves with `data.table` which is the data manipulation idiom that we will be using in the course.

- [[[https://raw.githack.com/uo-ec510-2020-spring/lectures/master/05-datatable/05-datatable.html][Here]]] is a lecture on the topic created by Grant McDermott at the University of Oregon.
- There is also a course, created by the package authors at Data Camp. I recommend that you **do not** take this course. The leadership at Data Camp was credibly accused of sexual harrassment, and as is described [[[https://www.buzzfeednews.com/article/daveyalba/datacamp-sexual-harassment-metoo-tech-startup][here]]] actively worked to avoid accountability. As an example, Rstudio has [[https://twitter.com/rstudio/status/1117889763711696896?lang=en][walked away]] from collaborating and teaching using Data Camp. The course exists, and Data Camp has removed the harrasser from leadership; we leave it to you to evaluate giving mind-share to the company, but don't provide a link.

** Compute Environment
There are several options for how to build a compute environment for this course.

- You have the option of using a one-click available [[http://r.datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/UCB-MIDS/w241&branch=master&urlpath=rstudio][UCB Datahub]] [<--link that syncs course content to datahub].
  + If you do not want to re-sync content, or manage the syncing yourself (via a shell) you can navigate to the Datahub directly: You can get to it [[http://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https://github.com/UCB-MIDS/w241&branch=master&urlpath=rstudio][here]].
  + This is a minimal instance -- you're capped at 1GB memory, but it is a really nice way to work on async coding without having to start any machinery of your own. You should be able to knit, save, and edit as you like.
  + The courses' upstream repository is /entirely/ segmented from your copy of this, so feel free to make any changes that you want. Note, however, that this also means that changes you make in the datahub will /not/ be present on your own fork of the repository. In other words, things that happen in the datahub, stay in the data hub.
- You can alternatively use this [[https://hub.docker.com/r/dalexhughes/w241][Docker image]] on your machine, or any other machine that has a docker engine. (This image builds from a canonical [[https://hub.docker.com/r/rocker/tidyverse][Rocker]] image).
  + This [[https://ropenscilabs.github.io/r-docker-tutorial/][short tutorial]] provided by ROpenSciLabs is just enough to get you going and dangerous.
- Finally, if you're brave, or you know the history of your computer, you can install locally.

** Books
We use two books in this course, and read a third book in the second week. We recommend that you buy a paper copy of the two textbooks (we've chosen textbooks that have a fair price), and would understand if you digitally read the third book. Support a local bookstore if you can; but, we've included a link to Amazon for those who cannot.

- /Field Experiments: Design and Analysis/ is the core textbook for the course. It is available on Amazon for $40 [[[https://www.amazon.com/Field-Experiments-Design-Analysis-Interpretation/dp/0393979954/ref%3Dsr_1_1?ie%3DUTF8&qid%3D1495560177&sr%3D8-1&keywords%3Dfield%2Bexperiments][link]]] and is necessary to succeed in the course.
- /Mastering Metrics/ is the secondary textbook for the course. It is available at Amazon for $20 [[[https://www.amazon.com/Mastering-Metrics-Path-Cause-Effect/dp/0691152845/ref%3Dsr_1_sc_1?ie%3DUTF8&qid%3D1495560224&sr%3D8-1-spell&keywords%3Dmastring%2Bmetrics][link]]].
- /Poor Economics/ is the third book for the course. It is available for purchase on Amazon for $15 [[[https://www.amazon.com/Poor-Economics-Radical-Rethinking-Poverty/dp/1610390938/ref=sr_1_1?dchild=1&keywords=poor+economics&qid=1608586471&sr=8-1][link]]], and from the UC Library digitally [[[https://ebookcentral-proquest-com.libproxy.berkeley.edu/lib/berkeley-ebooks/detail.action?docID=876489][link]]].
- /More than Good Intentions/ was previously used in the course. For folks with an interest in questions of development, it is an interesting read. It is available at Amazon for $10, new, or $3 used [[[https://www.amazon.com/More-Than-Good-Intentions-Improving/dp/0452297567/ref%3Dsr_1_1?ie%3DUTF8&qid%3D1495560260&sr%3D8-1&keywords%3Dmore%2Bthan%2Bgood%2Bintentions][link]]]. But, you could also read this digitally.

** Articles 
- We have made all the articles we read in the couse available in the repository. However, it is a /great/ practice to get used to establishing a VPN to gain access to all the journal articles that are available through the library subscription service. Instructions for connecting are available on the UCB [[https://www.lib.berkeley.edu/using-the-libraries/vpn][library website]]. Journal access is one of the greatest benefits to belonging to a University, we suggest you use it. 

- David has made a *great* resource that has suggestions for further reading. You can access it in this living [[https://docs.google.com/document/d/1IMsGTHmklhvetfJJfEm9dhoFM7bvb-YOkN_6mAM8kFM/edit?usp%3Dsharing][google doc]].

* Office Hours (all times Pacific) 

| *Day*               |      *Time* | *Instructor* |
|---------------------+-------------+--------------|
| Monday              |   5:30-6:30 | Alex         |
| Tuesday             |   5:30-6:30 | Scott        |
| Thursday            |   2:00-3:00 | Micah        |
| Thursday            |   5:30-6:30 | Scott        |
| (Friday before PS)  |   4:00-5:00 | Alex         |
| (Saturday after PS) | 9:00-10:00a | Alex         |


- In weeks where we have problem sets due, we will hold extra office hours on the Friday before the weekend. As well, when you are working through your project design, the instructors will schedule individual one-on-one conversations as necessary with student groups. 
- On Saturdays after we turn in problem sets, we will hold extra office hours to review the work that you've done and the feedback that you've received. For obvious reasons, you can only attend these Saturday OH if you have submitted your via PR.
 
* Grading and Scoring 

- *Problem Sets* (50%, 10% each) A series of problem sets, mostly drawn from FE, many requiring programming or analysis in R.
  - We encourage you to work together on problem sets, because great learning can come out of helping each other get unstuck.  We ask that each person independently prepare his or her own problem-set writeup, to demonstrate that you have thought through the ideas and calculations and can explain them on your own.  This includes making sure you run any code yourself and can explain how it works.   Collaboration is encouraged, but mere copying will be treated as academic dishonesty.
  - At this point, the course has lived for a number of semesters, and we have shared solution sets each semester. We note in particular that struggling with the problems is a key part of the learning in this course.  Copying from past solutions constitutes academic dishonesty and will be punished as such; you should know that we have included language in the solutions that will make it clear when something has been merely copied rather than understood.
- *Essays* (20%, 10% each) You will write two essays in the course. For each essay, you will first complete a round of peer-evaluation and will then submit a final, revised version of your essay for review by the instructor. These peer reviews will not be graded, but instead will be marked for credit/no-credit. 
- *Class Experiment* (25%) In teams of 3-5 students, carry out an experiment that measures a causal effect of interest. See the `./finalProject/` folder for much more information 
- *Experiment Pilot Data* (5%) Pilot data analysis of distribution of outcome variable and covariate balance check 
- *Late Policy*: You're busy and things come up -- kids get sick, parents stop by unannounced, managers ask you to reformat your [[https://www.youtube.com/watch?v%3DFy3rjQGc6lA][TPS reports]], you learn that your 261 project has accumulated $50,000 in compute costs -- we get it. You've got five (5) days to turn things in late without penalty, without explanation, and without notice. We'll count at the end of the semester. After you use those 5, each additional day (or part thereof) comes at the cost of 10% on the assignment. That is, 1% off your end-of-semester total grade. Here's the other twist though -- we need to provide solutions back to your classmates who *have* completed their work. So, no individual assignment can come in more than 5 days late; any assignment that does will score a zero. If you see ahead of time that you're going to have a conflict -- a major release, a vacation, etc. -- talk with your instructor to work out an alternative. We'll work with you, but the more notice, the better.
